plot <- ggplot(Result, aes(x=se_e, y=Power))+ #, label=label
geom_point()+
geom_line(size=1)+
theme_hc()+
ylab("")+
#scale_color_manual(values = c("deeppink", "skyblue3", "yellow3"))+
scale_x_continuous( breaks=se_e, labels=se_e)+
geom_vline(xintercept = 0.4, lty= 2, col = "slategrey")+
geom_vline(xintercept = 0.6, lty= 2, col = "slategrey")
Result[, se_e := c(0.15, 0.30, 0.40, 0.50, 0.60, 0.70, 0.85)]
library(data.table)
Result <- as.data.table(Result)
Result[, se_e := c(0.15, 0.30, 0.40, 0.50, 0.60, 0.70, 0.85)]
plot <- ggplot(Result, aes(x=se_e, y=Power))+ #, label=label
geom_point()+
geom_line(size=1)+
theme_hc()+
ylab("")+
#scale_color_manual(values = c("deeppink", "skyblue3", "yellow3"))+
scale_x_continuous( breaks=se_e, labels=se_e)+
geom_vline(xintercept = 0.4, lty= 2, col = "slategrey")+
geom_vline(xintercept = 0.6, lty= 2, col = "slategrey")
Result
plot <- ggplot(Result, aes(x=se_e, y=Power))+ #, label=label
geom_point()+
geom_line(size=1)+
theme_hc()+
ylab("")+
#scale_color_manual(values = c("deeppink", "skyblue3", "yellow3"))+
scale_x_continuous( breaks=se_e, labels=se_e)+
geom_vline(xintercept = 0.4, lty= 2, col = "slategrey")+
geom_vline(xintercept = 0.6, lty= 2, col = "slategrey")
Result
plot <- ggplot(Result, aes(x=se_e, y=Power))+ #, label=label
geom_point()+
geom_line(size=1)+
theme_hc()+
ylab("")+
#scale_color_manual(values = c("deeppink", "skyblue3", "yellow3"))+
#scale_x_continuous( breaks=se_e, labels=se_e)+
geom_vline(xintercept = 0.4, lty= 2, col = "slategrey")+
geom_vline(xintercept = 0.6, lty= 2, col = "slategrey")
plot
Result[, se_e := c(0.15, 0.30, 0.40, 0.50, 0.60, 0.70, 0.85)]
plot <- ggplot(Result, aes(x=se_e, y=Power))+ #, label=label
geom_point()+
geom_line(size=1)+
theme_hc()+
ylab("")+
#scale_color_manual(values = c("deeppink", "skyblue3", "yellow3"))+
#scale_x_continuous( breaks=se_e, labels=se_e)+
geom_vline(xintercept = 0.4, lty= 2, col = "slategrey")+
geom_vline(xintercept = 0.6, lty= 2, col = "slategrey")
#geom_label_repel(aes(label = label),
#                 box.padding   = 0.35,
#                 point.padding = 0.5,
#                 segment.color = 'slategrey')
ploty <- ggplotly(plot)
### Setting the working directory
if (!require("rstudioapi")) install.packages("rstudioapi")
thisdir<-setwd(dirname(rstudioapi::getSourceEditorContext()$path))
thisdir<-setwd(dirname(rstudioapi::getSourceEditorContext()$path))
setwd(thisdir)
### Loading parameters
source(paste0(thisdir,"/01_Parameters/ProgramParameters.R"))
Result[, se_e := c(0.15, 0.30, 0.40, 0.50, 0.60, 0.70, 0.85)]
plot <- ggplot(Result, aes(x=se_e, y=Power))+ #, label=label
geom_point()+
geom_line(size=1)+
theme_hc()+
ylab("")+
#scale_color_manual(values = c("deeppink", "skyblue3", "yellow3"))+
#scale_x_continuous( breaks=se_e, labels=se_e)+
geom_vline(xintercept = 0.4, lty= 2, col = "slategrey")+
geom_vline(xintercept = 0.6, lty= 2, col = "slategrey")
plot
library(shiny); runApp('08_dashboard/app_v2.R')
################################################################################
###########################      Bootstrap      ################################
################################################################################
# Sets A==1 and B==1
P_A_e = data[A==1&E==1, .N]/data[E==1, .N]
P_A_ne = data[A==1&E==0, .N]/data[E==0, .N]
P_B_e = data[B==1&E==1, .N]/data[E==1, .N]
P_B_ne = data[B==1&E==0, .N]/data[E==0, .N]
P_C_e = data[C==1&E==1, .N]/data[E==1, .N]
P_C_ne = data[C==1&E==0, .N]/data[E==0, .N]
P_A =  data[A==1, .N]/N
P_B = data[B==1, .N]/N
P_C = data[C==1, .N]/N
DT_A <- data[A==1]
DT_B <- data[B==1]
DT_C <- data[C==1]
#bootstrap_power
PPV_A_e = PPV_A_ne = PPV_B_e = PPV_B_ne = PPV_C_e = PPV_C_ne = NULL
n1=n2=n3=n4=NULL
tx_boot=c()
TX_boot0=TX_boot2=matrix(0,nsam,nboot)
PPV_A_e0=PPV_A_ne0=PPV_B_e0=PPV_B_ne0=PPV_C_e0=PPV_C_ne0=matrix(0,nsam,nboot)
PPV_A_e2=PPV_A_ne2=PPV_B_e2=PPV_B_ne2=PPV_C_e2=PPV_C_ne2=matrix(0,nsam,nboot)
#set.seed(2908)
PPV_A_e0
sam_Ya1 = DT_A[sample(nrow(DT_A),na),]
sam_Yb1 = DT_B[sample(nrow(DT_B),nb),]
sam_Ya1
DT_A
View(sam_Ya1)
temp_sam_Yc1 = rbind(sam_Ya1, sam_Yb1)
temp_sam_Yc1 = temp_sam_Yc1[C==1]
temp_sam_Yc1
sam_Yc1 = temp_sam_Yc1[sample(nrow(temp_sam_Yc1), min(nc, nrow(temp_sam_Yc1))),]
sam_Yc1
################################################################################
###########################      Bootstrap      ################################
################################################################################
# Sets A==1 and B==1
P_A_e = data[A==1&E==1, .N]/data[E==1, .N]
P_A_ne = data[A==1&E==0, .N]/data[E==0, .N]
P_B_e = data[B==1&E==1, .N]/data[E==1, .N]
P_B_ne = data[B==1&E==0, .N]/data[E==0, .N]
P_C_e = data[C==1&E==1, .N]/data[E==1, .N]
P_C_ne = data[C==1&E==0, .N]/data[E==0, .N]
P_A =  data[A==1, .N]/N
P_B = data[B==1, .N]/N
P_C = data[C==1, .N]/N
DT_A <- data[A==1]
DT_B <- data[B==1]
#DT_C <- data[C==1]
#bootstrap_power
PPV_A_e = PPV_A_ne = PPV_B_e = PPV_B_ne = PPV_C_e = PPV_C_ne = NULL
n1=n2=n3=n4=NULL
tx_boot=c()
TX_boot0=TX_boot2=matrix(0,nsam,nboot)
PPV_A_e0=PPV_A_ne0=PPV_B_e0=PPV_B_ne0=PPV_C_e0=PPV_C_ne0=matrix(0,nsam,nboot)
PPV_A_e2=PPV_A_ne2=PPV_B_e2=PPV_B_ne2=PPV_C_e2=PPV_C_ne2=matrix(0,nsam,nboot)
#set.seed(2908)
for(i in 1:nsam){
sam_Ya1 = DT_A[sample(nrow(DT_A),na),]
sam_Yb1 = DT_B[sample(nrow(DT_B),nb),]
#sam_Yc1 = DT_C[sample(nrow(DT_C),nc),]
temp_sam_Yc1 = rbind(sam_Ya1, sam_Yb1)
temp_sam_Yc1 = temp_sam_Yc1[C==1]
sam_Yc1 = temp_sam_Yc1[sample(nrow(temp_sam_Yc1), min(nc, nrow(temp_sam_Yc1))),]
for(j in 1:nboot){
sam_Ya_boot = sam_Ya1[sample(nrow(sam_Ya1), na, replace = TRUE),]
sam_Yb_boot = sam_Yb1[sample(nrow(sam_Yb1), nb, replace = TRUE),]
sam_Yc_boot = sam_Yc1[sample(nrow(sam_Yc1), min(nc, nrow(temp_sam_Yc1)), replace = TRUE),]
PPV_A_e0[i,j] = (sum(sam_Ya_boot$A==1&sam_Ya_boot$Y==1&sam_Ya_boot$E==1))/(sum(sam_Ya_boot$A==1&sam_Ya_boot$E==1))
PPV_B_e0[i,j] = (sum(sam_Yb_boot$B==1&sam_Yb_boot$Y==1&sam_Yb_boot$E==1))/(sum(sam_Yb_boot$B==1&sam_Yb_boot$E==1))
PPV_C_e0[i,j] = (sum(sam_Yc_boot$C==1&sam_Yc_boot$Y==1&sam_Yc_boot$E==1))/(sum(sam_Yc_boot$C==1&sam_Yc_boot$E==1))
PPV_A_ne0[i,j] = (sum(sam_Ya_boot$A==1&sam_Ya_boot$Y==1&sam_Ya_boot$E==0))/(sum(sam_Ya_boot$A==1&sam_Ya_boot$E==0))
PPV_B_ne0[i,j] = (sum(sam_Yb_boot$B==1&sam_Yb_boot$Y==1&sam_Yb_boot$E==0))/(sum(sam_Yb_boot$B==1&sam_Yb_boot$E==0))
PPV_C_ne0[i,j] = (sum(sam_Yc_boot$C==1&sam_Yc_boot$Y==1&sam_Yc_boot$E==0))/(sum(sam_Yc_boot$C==1&sam_Yc_boot$E==0))
TX_boot0[i,j] = statistic_with_C_sample(P_A_e = P_A_e,
P_B_e = P_B_e,
P_C_e = P_C_e,
P_A_ne = P_A_ne,
P_B_ne = P_B_ne,
P_C_ne = P_C_ne,
PPV_A_e =  PPV_A_e0[i,j],
PPV_B_e =  PPV_B_e0[i,j],
PPV_C_e =  PPV_C_e0[i,j],
PPV_A_ne = PPV_A_ne0[i,j],
PPV_B_ne =  PPV_B_ne0[i,j],
PPV_C_ne =  PPV_C_ne0[i,j])
}
}
#set.seed(2908)
for(i in 1:nsam){
sam_Ya_boot = sam_Ya1[sample(nrow(sam_Ya1), na, replace = TRUE),]
sam_Yb_boot = sam_Yb1[sample(nrow(sam_Yb1), nb, replace = TRUE),]
sam_Yc_boot = sam_Yc1[sample(nrow(sam_Yc1), nc, replace = TRUE),]
for(j in 1:nboot){
PPV_B_e2[i,j] = ifelse( PPV_B_e0[i,j]>0 & (!is.na(PPV_B_e0[i,j])) & PPV_B_e0[i,j] != Inf,
PPV_B_e0[i,j],  1/(2*sum(sam_Yb_boot$B==1&sam_Yb_boot$E==1)))
PPV_A_e2[i,j] = ifelse( PPV_A_e0[i,j]>0 & (!is.na(PPV_A_e0[i,j])) & PPV_A_e0[i,j] != Inf,
PPV_A_e0[i,j],  1/(2*sum(sam_Ya_boot$A==1&sam_Ya_boot$E==1)))
PPV_C_e2[i,j] = ifelse( PPV_C_e0[i,j]>0 & (!is.na(PPV_C_e0[i,j])) & PPV_C_e0[i,j] != Inf,
PPV_C_e0[i,j],  1/(2*sum(sam_Yc_boot$C==1&sam_Yc_boot$E==1)))
PPV_B_ne2[i,j] = ifelse( PPV_B_ne0[i,j]>0 & (!is.na(PPV_B_ne0[i,j])) & PPV_B_ne0[i,j] != Inf,
PPV_B_ne0[i,j],  1/(2*sum(sam_Yb_boot$B==1&sam_Yb_boot$E==0)))
PPV_A_ne2[i,j] = ifelse( PPV_A_ne0[i,j]>0 & (!is.na(PPV_A_ne0[i,j])) & PPV_A_ne0[i,j] != Inf,
PPV_A_ne0[i,j],  1/(2*sum(sam_Ya_boot$A==1&sam_Ya_boot$E==0)))
PPV_C_ne2[i,j] = ifelse( PPV_C_ne0[i,j]>0 & (!is.na(PPV_C_ne0[i,j])) & PPV_C_ne0[i,j] != Inf,
PPV_C_ne0[i,j],  1/(2*sum(sam_Yc_boot$C==1&sam_Yc_boot$E==0)))
TX_boot2[i,j] = statistic_with_C_sample(P_A_e = P_A_e,
P_B_e = P_B_e,
P_C_e = P_C_e,
P_A_ne = P_A_ne,
P_B_ne = P_B_ne,
P_C_ne = P_C_ne,
PPV_A_e =  PPV_A_e2[i,j],
PPV_B_e =  PPV_B_e2[i,j],
PPV_C_e =  PPV_C_e2[i,j],
PPV_A_ne = PPV_A_ne2[i,j],
PPV_B_ne =  PPV_B_ne2[i,j],
PPV_C_ne =  PPV_C_ne2[i,j])
}
}
quant_025 = quant_975 = c()
for(i in 1:nsam){
quant_025[i] = quantile(TX_boot2[i,],0.025, na.rm = T)
quant_975[i] = quantile(TX_boot2[i,],0.975, na.rm = T)
}
acc_95 = length(which(quant_025 < 0 & quant_975>0 ))/nsam
rej_95 = 1-acc_95
test_power = rej_95
test_power
151*84
84/12
rm(list=ls(all.names=TRUE))
### Setting the working directory
if (!require("rstudioapi")) install.packages("rstudioapi")
thisdir<-setwd(dirname(rstudioapi::getSourceEditorContext()$path))
thisdir<-setwd(dirname(rstudioapi::getSourceEditorContext()$path))
setwd(thisdir)
### Loading parameters
source(paste0(thisdir,"/01_Parameters/ProgramParameters.R"))
### Loading test statistic
source(paste0(thisdir,"/02_TestFunctions/TestStatistic.R"))
################################################################################
###################                Simulation                ###################
################################################################################
prop_exp_list    <- c(0.2)
pi_ne_list       <- c(0.05)
risk_list        <- c(2)
SE_exposed_list  <- c(0.15, 0.30, 0.40, 0.50, 0.60, 0.70, 0.85)
sample_size_list <- c(250)
counter <- 0
len <- length(prop_exp_list)*
length(pi_ne_list)*
length(risk_list)*
length(SE_exposed_list)*
length(sample_size_list)
TestPower <- c()
combination <- c()
time.taken <- c()
DT_comb <- data.table(prop_exp = integer(0),
prev_ne = integer(0),
risk = integer(0),
SE_exp = integer(0),
power = integer(0),
sample_size = integer(0),
SE_AUB = integer(0),
SE_A_e = integer(0),
SE_B_given_A_e  = integer(0),
SE_A_int_B_e = integer(0),
SE_B_e = integer(0),
SE_A_given_B_e = integer(0),
SE_B_given_not_A_e = integer(0),
SE_A_ne = integer(0),
SE_B_given_A_ne = integer(0),
SE_A_int_B_ne = integer(0),
SE_B_ne = integer(0),
SE_A_given_B_ne = integer(0),
SE_B_given_not_A_ne = integer(0),
SP_A_e = integer(0),
SP_B_e = integer(0),
SP_A_ne = integer(0),
SP_B_ne = integer(0))
for (h in prop_exp_list) {
for (w in pi_ne_list) {
for (t in risk_list) {
for (k in SE_exposed_list) {
for (z in sample_size_list) {
start.time <- Sys.time()
combination <- c(combination, paste0(h, "_", w, "_", t, "_", k))
### setting parameters
source(paste0(thisdir,"/01_Parameters/TestParameters_hwtk_2.R"))
### Loading data
source(paste0(thisdir,"/03_DataGen/ConditionalProbability.R"))
### Test
source(paste0(thisdir,"/04_TestApplication/TestPower_C_from_AB.R"))
tmp <- data.table(prop_exp = h,
prev_ne = w,
risk = t,
SE_exp = k,
power = rej_95,
sample_size = z,
SE_AUB = SE_AUB,
SE_A_e = SE_A_e,
SE_B_given_A_e  = SE_B_given_A_e,
SE_A_int_B_e = SE_A_int_B_e,
SE_B_e = SE_B_e,
SE_A_given_B_e = SE_A_given_B_e ,
SE_B_given_not_A_e = SE_B_given_not_A_e,
SE_A_ne = SE_A_ne,
SE_B_given_A_ne = SE_B_given_A_ne,
SE_A_int_B_ne = SE_A_int_B_ne,
SE_B_ne = SE_B_ne,
SE_A_given_B_ne = SE_A_given_B_ne,
SE_B_given_not_A_ne = SE_B_given_not_A_ne,
SP_A_e = SP_A_e,
SP_B_e = SP_B_e,
SP_A_ne = SP_A_ne,
SP_B_ne = SP_B_ne)
DT_comb <- rbind(DT_comb, tmp)
TestPower <- c(TestPower, rej_95)
end.time <- Sys.time()
time.taken <- c(time.taken, (end.time - start.time))
counter <- counter + 1
print(paste0(counter, "/" , len))
}
}
}
}
}
fwrite(DT_comb, paste0(thisdir, "/05_Results/DT_comb_sample_250_C_from_AB.csv"))
Result <- data.table(Power = TestPower, combination = combination)
fwrite(Result, paste0(thisdir, "/05_Results/C_sample_C_from_AB.csv"))
rm(list=ls(all.names=TRUE))
### Setting the working directory
if (!require("rstudioapi")) install.packages("rstudioapi")
thisdir<-setwd(dirname(rstudioapi::getSourceEditorContext()$path))
thisdir<-setwd(dirname(rstudioapi::getSourceEditorContext()$path))
setwd(thisdir)
### Loading parameters
source(paste0(thisdir,"/01_Parameters/ProgramParameters.R"))
### Loading test statistic
source(paste0(thisdir,"/02_TestFunctions/TestStatistic.R"))
################################################################################
###################                Simulation                ###################
################################################################################
prop_exp_list    <- c(0.2)
pi_ne_list       <- c(0.05)
risk_list        <- c(2)
SE_exposed_list  <- c(0.15, 0.30, 0.40, 0.50, 0.60, 0.70, 0.85)
sample_size_list <- c(250)
counter <- 0
len <- length(prop_exp_list)*
length(pi_ne_list)*
length(risk_list)*
length(SE_exposed_list)*
length(sample_size_list)
TestPower <- c()
combination <- c()
time.taken <- c()
DT_comb <- data.table(prop_exp = integer(0),
prev_ne = integer(0),
risk = integer(0),
SE_exp = integer(0),
power = integer(0),
sample_size = integer(0),
SE_AUB = integer(0),
SE_A_e = integer(0),
SE_B_given_A_e  = integer(0),
SE_A_int_B_e = integer(0),
SE_B_e = integer(0),
SE_A_given_B_e = integer(0),
SE_B_given_not_A_e = integer(0),
SE_A_ne = integer(0),
SE_B_given_A_ne = integer(0),
SE_A_int_B_ne = integer(0),
SE_B_ne = integer(0),
SE_A_given_B_ne = integer(0),
SE_B_given_not_A_ne = integer(0),
SP_A_e = integer(0),
SP_B_e = integer(0),
SP_A_ne = integer(0),
SP_B_ne = integer(0))
for (h in prop_exp_list) {
for (w in pi_ne_list) {
for (t in risk_list) {
for (k in SE_exposed_list) {
for (z in sample_size_list) {
start.time <- Sys.time()
combination <- c(combination, paste0(h, "_", w, "_", t, "_", k))
### setting parameters
source(paste0(thisdir,"/01_Parameters/TestParameters_hwtk_2.R"))
### Loading data
source(paste0(thisdir,"/03_DataGen/ConditionalProbability.R"))
### Test
source(paste0(thisdir,"/04_TestApplication/TestPower_C_from_AB.R"))
tmp <- data.table(prop_exp = h,
prev_ne = w,
risk = t,
SE_exp = k,
power = rej_95,
sample_size = z,
SE_AUB = SE_AUB,
SE_A_e = SE_A_e,
SE_B_given_A_e  = SE_B_given_A_e,
SE_A_int_B_e = SE_A_int_B_e,
SE_B_e = SE_B_e,
SE_A_given_B_e = SE_A_given_B_e ,
SE_B_given_not_A_e = SE_B_given_not_A_e,
SE_A_ne = SE_A_ne,
SE_B_given_A_ne = SE_B_given_A_ne,
SE_A_int_B_ne = SE_A_int_B_ne,
SE_B_ne = SE_B_ne,
SE_A_given_B_ne = SE_A_given_B_ne,
SE_B_given_not_A_ne = SE_B_given_not_A_ne,
SP_A_e = SP_A_e,
SP_B_e = SP_B_e,
SP_A_ne = SP_A_ne,
SP_B_ne = SP_B_ne)
DT_comb <- rbind(DT_comb, tmp)
TestPower <- c(TestPower, rej_95)
end.time <- Sys.time()
time.taken <- c(time.taken, (end.time - start.time))
counter <- counter + 1
print(paste0(counter, "/" , len))
}
}
}
}
}
fwrite(DT_comb, paste0(thisdir, "/05_Results/DT_comb_sample_250_C_from_AB.csv"))
Result <- data.table(Power = TestPower, combination = combination)
fwrite(Result, paste0(thisdir, "/05_Results/C_sample_C_from_AB.csv"))
rm(list=ls(all.names=TRUE))
### Setting the working directory
if (!require("rstudioapi")) install.packages("rstudioapi")
thisdir<-setwd(dirname(rstudioapi::getSourceEditorContext()$path))
thisdir<-setwd(dirname(rstudioapi::getSourceEditorContext()$path))
setwd(thisdir)
### Loading parameters
source(paste0(thisdir,"/01_Parameters/ProgramParameters.R"))
### Loading test statistic
source(paste0(thisdir,"/02_TestFunctions/TestStatistic.R"))
################################################################################
###################                Simulation                ###################
################################################################################
prop_exp_list    <- c(0.2)
pi_ne_list       <- c(0.05)
risk_list        <- c(2)
SE_exposed_list  <- c(0.15, 0.30, 0.40, 0.50, 0.60, 0.70, 0.85)
sample_size_list <- c(250)
counter <- 0
len <- length(prop_exp_list)*
length(pi_ne_list)*
length(risk_list)*
length(SE_exposed_list)*
length(sample_size_list)
TestPower <- c()
combination <- c()
time.taken <- c()
DT_comb <- data.table(prop_exp = integer(0),
prev_ne = integer(0),
risk = integer(0),
SE_exp = integer(0),
power = integer(0),
sample_size = integer(0),
SE_AUB = integer(0),
SE_A_e = integer(0),
SE_B_given_A_e  = integer(0),
SE_A_int_B_e = integer(0),
SE_B_e = integer(0),
SE_A_given_B_e = integer(0),
SE_B_given_not_A_e = integer(0),
SE_A_ne = integer(0),
SE_B_given_A_ne = integer(0),
SE_A_int_B_ne = integer(0),
SE_B_ne = integer(0),
SE_A_given_B_ne = integer(0),
SE_B_given_not_A_ne = integer(0),
SP_A_e = integer(0),
SP_B_e = integer(0),
SP_A_ne = integer(0),
SP_B_ne = integer(0))
for (h in prop_exp_list) {
for (w in pi_ne_list) {
for (t in risk_list) {
for (k in SE_exposed_list) {
for (z in sample_size_list) {
start.time <- Sys.time()
combination <- c(combination, paste0(h, "_", w, "_", t, "_", k))
### setting parameters
source(paste0(thisdir,"/01_Parameters/TestParameters_hwtk_2.R"))
### Loading data
source(paste0(thisdir,"/03_DataGen/ConditionalProbability.R"))
### Test
source(paste0(thisdir,"/04_TestApplication/TestPower.R"))
tmp <- data.table(prop_exp = h,
prev_ne = w,
risk = t,
SE_exp = k,
power = rej_95,
sample_size = z,
SE_AUB = SE_AUB,
SE_A_e = SE_A_e,
SE_B_given_A_e  = SE_B_given_A_e,
SE_A_int_B_e = SE_A_int_B_e,
SE_B_e = SE_B_e,
SE_A_given_B_e = SE_A_given_B_e ,
SE_B_given_not_A_e = SE_B_given_not_A_e,
SE_A_ne = SE_A_ne,
SE_B_given_A_ne = SE_B_given_A_ne,
SE_A_int_B_ne = SE_A_int_B_ne,
SE_B_ne = SE_B_ne,
SE_A_given_B_ne = SE_A_given_B_ne,
SE_B_given_not_A_ne = SE_B_given_not_A_ne,
SP_A_e = SP_A_e,
SP_B_e = SP_B_e,
SP_A_ne = SP_A_ne,
SP_B_ne = SP_B_ne)
DT_comb <- rbind(DT_comb, tmp)
TestPower <- c(TestPower, rej_95)
end.time <- Sys.time()
time.taken <- c(time.taken, (end.time - start.time))
counter <- counter + 1
print(paste0(counter, "/" , len))
}
}
}
}
}
fwrite(DT_comb, paste0(thisdir, "/05_Results/DT_comb_sample_250_max_PPV_A_B.csv"))
Result <- data.table(Power = TestPower, combination = combination)
fwrite(Result, paste0(thisdir, "/05_Results/Results_max_PPV_A_B.csv"))
#save.image("H:/Seafile/Mia Libreria/GitHub_Repo/NonDifferentialityTest/Rscript/05_Results/env.RData")
library(shiny); runApp('08_dashboard/app_v3_C_sample.R')
